---
import AppLayout from "../../layouts/AppLayout.astro";
---

<AppLayout>
  <section style="max-width: 1200px; margin: 0 auto; padding: 2rem 1.25rem;">
    <!-- InformaciÃ³n -->
    <div
      style="background: #dbeafe; border: 1px solid #93c5fd; border-radius: 0.5rem; padding: 1rem; margin-bottom: 2rem;"
    >
      <strong style="color: #1e40af;">ğŸ’¡ Nota:</strong> Esta pÃ¡gina estÃ¡ optimizada
      para dispositivos mÃ³viles.
    </div>

    <!-- Opciones para ADMIN -->
    <div id="adminOptions" style="display: none;">
      <h2
        style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem; color: #8b6f47;"
      >
        ğŸ”§ GestiÃ³n Operativa (Admin)
      </h2>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;"
      >
        <!-- 1. Recoger Lote en Finca -->
        <a href="/app/harvest" style="text-decoration: none; color: inherit;">
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸŒ±</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              1. Recoger Lote en Finca
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Registrar nuevo lote reciÃ©n cosechado desde la finca
            </p>
          </div>
        </a>

        <!-- 2. Almacenar en Inventario -->
        <a
          href="/app/inventory-storage"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“¦</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              2. Almacenar en Inventario
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Registrar entrada de cafÃ© verde al almacÃ©n
            </p>
          </div>
        </a>

        <!-- 3. Enviar a TostiÃ³n -->
        <a
          href="/app/send-roasting"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ”¥</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              3. Enviar a TostiÃ³n
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Preparar y enviar lote al proceso de tueste
            </p>
          </div>
        </a>

        <!-- 4. Recoger del Tueste -->
        <a
          href="/app/roast-retrieval"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">â˜•</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              4. Recoger del Tueste
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Recibir cafÃ© tostado y verificar calidad
            </p>
          </div>
        </a>

        <!-- 5. Almacenar Tostado -->
        <a
          href="/app/roasted-storage"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸº</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              5. Almacenar Tostado
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Guardar cafÃ© tostado en inventario de producto terminado
            </p>
          </div>
        </a>

        <!-- 6. Preparar para Venta -->
        <a href="/app/packaging" style="text-decoration: none; color: inherit;">
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“¦</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              6. Preparar para Venta
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Empacar y etiquetar producto final para venta
            </p>
          </div>
        </a>

        <!-- GestiÃ³n de Usuarios (Solo Admin) -->
        <a
          href="/app/usuarios"
          style="text-decoration: none; color: inherit;"
          id="usersLink"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ‘¥</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              GestiÃ³n de Usuarios
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Ver y administrar todos los usuarios del sistema
            </p>
          </div>
        </a>

        <!-- GestiÃ³n de Productos (Solo Admin) -->
        <a
          href="/app/productos"
          style="text-decoration: none; color: inherit;"
          id="productsLink"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“¦</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              GestiÃ³n de Productos
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Crear, editar y administrar productos de la tienda en lÃ­nea
            </p>
          </div>
        </a>

        <!-- Mapa de Calor de Ventas (Solo Admin) -->
        <a
          href="/app/ventas"
          id="salesMapLink"
          style="display: none;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ—ºï¸</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              Mapa de Ventas
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Visualiza la distribuciÃ³n geogrÃ¡fica de tus ventas en Colombia
            </p>
          </div>
        </a>
      </div>
    </div>

    <!-- AuditorÃ­a (Solo Admin) -->
    <div id="auditSection" style="display: none;">
      <h2
        style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem; color: #8b6f47;"
      >
        ğŸ” Seguridad y AuditorÃ­a
      </h2>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;"
      >
        <!-- AuditorÃ­a -->
        <a
          href="/app/auditoria"
          style="display: block; padding: 2rem; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-decoration: none; color: inherit; transition: transform 0.2s, box-shadow 0.2s;"
          onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.15)';"
          onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)';"
        >
          <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“‹</div>
          <h3 style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;">
            AuditorÃ­a del Sistema
          </h3>
          <p style="color: #666; font-size: 0.95rem;">
            Registros de todas las acciones realizadas en el sistema
          </p>
        </a>
      </div>
    </div>

    <!-- Opciones para CAFICULTOR y ADMIN -->
    <div id="caficultorOptions">
      <h2
        style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem; color: #8b6f47;"
      >
        ğŸ“Š GestiÃ³n y Reportes
      </h2>
      <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;"
      >
        <!-- Ver Lotes Entregados -->
        <a
          href="/app/lotes-entregados"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“‹</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              Ver Lotes Entregados
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Historial de lotes entregados y su estado
            </p>
          </div>
        </a>

        <!-- EstadÃ­sticas -->
        <a
          href="/app/estadisticas"
          style="text-decoration: none; color: inherit;"
        >
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ“ˆ</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              EstadÃ­sticas
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              MÃ©tricas de producciÃ³n y calidad
            </p>
          </div>
        </a>

        <!-- Finanzas -->
        <a href="/app/finanzas" style="text-decoration: none; color: inherit;">
          <div
            style="background: white; border: 1px solid #e5e7eb; border-radius: 0.75rem; padding: 1.5rem; transition: all 0.3s; cursor: pointer;"
            onmouseover="this.style.borderColor='#8b6f47'; this.style.boxShadow='0 4px 12px rgba(139,111,71,0.15)'"
            onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
          >
            <div style="font-size: 2.5rem; margin-bottom: 0.75rem;">ğŸ’°</div>
            <h3
              style="font-weight: 600; margin-bottom: 0.5rem; color: #251a14;"
            >
              Finanzas
            </h3>
            <p style="color: #666; font-size: 0.95rem;">
              Pagos, ingresos y balance general
            </p>
          </div>
        </a>
      </div>
    </div>
  </section>
</AppLayout>

<style>
  a {
    text-decoration: none;
  }
</style>

<script>
  // Mostrar opciones segÃºn rol del usuario
  (function () {
    // Esperar a que el rol estÃ© disponible (seteado por AppLayout)
    const checkRole = setInterval(() => {
      if (window.userRole) {
        clearInterval(checkRole);

        const adminOptions = document.getElementById("adminOptions");
        const caficultorOptions = document.getElementById("caficultorOptions");
        const usersLink = document.getElementById("usersLink");
        const productsLink = document.getElementById("productsLink");
        const salesMapLink = document.getElementById("salesMapLink");
        const auditSection = document.getElementById("auditSection");

        if (window.userRole === "admin") {
          // Admin ve todo
          if (adminOptions) adminOptions.style.display = "block";
          if (caficultorOptions) caficultorOptions.style.display = "block";
          if (usersLink) usersLink.style.display = "block";
          if (productsLink) productsLink.style.display = "block";
          if (salesMapLink) salesMapLink.style.display = "block";
          if (auditSection) auditSection.style.display = "block";
        } else if (window.userRole === "caficultor") {
          // Caficultor solo ve sus opciones
          if (adminOptions) adminOptions.style.display = "none";
          if (caficultorOptions) caficultorOptions.style.display = "block";
          if (usersLink) usersLink.style.display = "none";
          if (productsLink) productsLink.style.display = "none";
          if (auditSection) auditSection.style.display = "none";
        }
      }
    }, 50);

    // Timeout despuÃ©s de 5 segundos
    setTimeout(() => clearInterval(checkRole), 5000);
  })();
</script>
